module.exports = function (grunt) {
    grunt.registerTask('useSpecificStyle', 'When the "cssName" parameter is passed, we want to use that certain css style', function (taskParam) {
        var cssName = grunt.option('cssname'); // Possible values are 'wgk', 'vkz' or no value. Pass them as: "grunt serve -cssname wgk".

        function isCssNameUndefinedOrEqualsvkz() {
            return typeof cssName === 'undefined' || cssName === 'vkz';
        }

        function isNotRelease() {
            if (taskParam === 'release') {
                if(isCssNameUndefinedOrEqualsvkz()){
                    grunt.task.run('cssmin:release');
                } else  {
                    grunt.task.run('cssmin:release_specific:' + cssName);
                }
                return false;
            }
            return true;
        }

        if(isNotRelease()){
            var wwwFolder = 'www/css/';
            var fileNotToDelete = isCssNameUndefinedOrEqualsvkz() ? 'custom.css' : 'custom-' + cssName + '.css';

            // Function to check if a certain string starts with a different one.
            var startsWith = function (fullString, partOfString) {
                return fullString.indexOf(partOfString) === 0;
            };
            // Delete all the 'custom' files except for the requested one.
            grunt.file.recurse(wwwFolder, function (abspath, rootdir, subdir, filename) {
                if (startsWith(filename, 'custom') && filename !== fileNotToDelete) {
                    grunt.file.delete(abspath);
                }
            });
        }
    });
};
